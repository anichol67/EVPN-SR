# --------------------------------------------------------------
# EVPN Services with MPLS-SR core
# VPWS, IRB, OISM, IP-VPN
# --------------------------------------------------------------

name: EVO

prefix: ""

mgmt:
  network: mgmt
  ipv4-subnet: 172.100.100.0/24

topology:

  defaults:
    env:
      INTFTYPE: et

  kinds:
    ceos:
      image: ceos:4.35.0F
      env:
        CLAB_MGMT_VRF: MGMT
    linux:
      image: ghcr.io/aristanetworks/aclabs/host-ubuntu:rev1.0

  nodes:

    PE-01:
      kind: ceos
      mgmt-ipv4: 172.100.100.104
      binds:
        - sn/PE01.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/PE01.cfg
      ports:
        - '22004:22'
        - '8004:80'
        - '44304:443'
    PE-02:
      kind: ceos
      mgmt-ipv4: 172.100.100.105
      binds:
        - sn/PE02.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/PE02.cfg
      ports:
        - '22005:22'
        - '8005:80'
        - '44305:443'
    P-03:
      kind: ceos
      mgmt-ipv4: 172.100.100.106
      binds:
        - sn/P03.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/P03.cfg
      ports:
        - '22006:22'
        - '8006:80'
        - '44306:443'
    P-04:
      kind: ceos
      mgmt-ipv4: 172.100.100.107
      binds:
        - sn/P04.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/P04.cfg
      ports:
        - '22007:22'
        - '8007:80'
        - '44307:443'
    P-05:
      kind: ceos
      mgmt-ipv4: 172.100.100.108
      binds:
        - sn/P05.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/P05.cfg
      ports:
        - '22008:22'
        - '8008:80'
        - '44308:443'
    P-06:
      kind: ceos
      mgmt-ipv4: 172.100.100.109
      binds:
        - sn/P06.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/P06.cfg
      ports:
        - '22009:22'
        - '8009:80'
        - '44309:443'    
    PE-07:
      kind: ceos
      mgmt-ipv4: 172.100.100.110
      binds:
        - sn/PE07.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/PE07.cfg
      ports:
        - '22010:22'
        - '8010:80'
        - '44310:443'
    PE-08:
      kind: ceos
      mgmt-ipv4: 172.100.100.111
      binds:
        - sn/PE08.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/PE08.cfg
      ports:
        - '22011:22'
        - '8011:80'
        - '44311:443'
 
    CE-1:
      kind: ceos
      mgmt-ipv4: 172.100.100.112
      binds:
        - sn/CE01.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/CE1.cfg
      ports:
        - '22015:22'
        - '8015:80'
        - '44315:443'
    CE-2:
      kind: ceos
      mgmt-ipv4: 172.100.100.113
      binds:
        - sn/CE02.txt:/mnt/flash/ceos-config:ro
        - toggles/toggle_override:/mnt/flash/toggle_override
      startup-config: init-configs/CE2.cfg
      ports:
        - '22016:22'
        - '8016:80'
        - '44316:443'   
   
    Host1:
      kind: linux
      mgmt-ipv4: 172.100.100.201
      exec:
       # Command to add an IP address to the host interface after creation
       - ip address add 10.10.10.101/24 dev et1
       - ip route add 10.10.0.0/16 via 10.10.10.254
      ports:
        - '22017:22'
        - '8017:80'
        - '44317:443'
    Host2:
      kind: linux
      mgmt-ipv4: 172.100.100.202
      exec:
       # Command to add an IP address to the host interface after creation
       - ip address add 10.10.10.102/24 dev et1
       - ip route add 10.10.0.0/16 via 10.10.10.254
      ports:
        - '22018:22'
        - '8018:80'
        - '44318:443'    
    Host3:
      kind: linux
      mgmt-ipv4: 172.100.100.203
      exec:
       # Command to add an IP address to the host interface after creation
       - ip address add 10.10.20.101/24 dev et1
       - ip route add 10.10.0.0/16 via 10.10.20.254
      ports:
        - '22019:22'
        - '8019:80'
        - '44319:443'
    Host4:
      kind: linux
      mgmt-ipv4: 172.100.100.204
      exec:
       # Command to add an IP address to the host interface after creation
       - ip address add 10.10.20.102/24 dev et1
       - ip route add 10.10.0.0/16 via 10.10.20.254
      ports:
        -  '22020:22'
        - '8020:80'
        - '44320:443'    

  links:
    - endpoints: [ "CE-1:et10", "Host1:et1"]
    - endpoints: [ "CE-1:et11", "Host2:et1"]
    - endpoints: [ "CE-2:et10", "Host3:et1"]
    - endpoints: [ "CE-2:et11", "Host4:et1"]
    - endpoints: [ "CE-1:et1",  "PE-01:et10" ]
    - endpoints: [ "CE-1:et2",  "PE-02:et10" ]
    - endpoints: [ "CE-2:et1",  "PE-07:et10" ]
    - endpoints: [ "CE-2:et2",  "PE-08:et10" ]
    - endpoints: [ "PE-01:et4", "P-03:et1" ]
    - endpoints: [ "PE-01:et5", "P-04:et1" ]
    - endpoints: [ "PE-01:et6", "PE-02:et6" ]
    - endpoints: [ "PE-02:et4", "P-03:et2" ]
    - endpoints: [ "PE-02:et5", "P-04:et2" ]
    - endpoints: [ "P-03:et4", "P-05:et1" ]
    - endpoints: [ "P-03:et5", "P-06:et1" ]
    - endpoints: [ "P-03:et6", "P-04:et6" ]
    - endpoints: [ "P-04:et4", "P-05:et2" ]
    - endpoints: [ "P-04:et5", "P-06:et2" ]
    - endpoints: [ "P-05:et4", "PE-07:et1" ]
    - endpoints: [ "P-05:et5", "PE-08:et1" ]
    - endpoints: [ "P-05:et6", "P-06:et6" ]
    - endpoints: [ "P-06:et4", "PE-07:et2" ]
    - endpoints: [ "P-06:et5", "PE-08:et2" ]
    - endpoints: [ "PE-07:et6", "PE-08:et6" ]
    
    
    

     
    
    

